<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Finanza & Focus</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; }
        
        /* Griglia Layout */
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .dashboard-grid { grid-template-columns: 1fr; } }

        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h2 { margin-top: 0; font-size: 1.2rem; color: #2c3e50; border-bottom: 2px solid #eee; padding-bottom: 10px; }

        /* Obiettivi Risparmio */
        .goal-input-group { display: flex; gap: 10px; margin-bottom: 15px; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 6px; width: 100%; }
        button { cursor: pointer; border: none; padding: 8px 15px; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn-add { background-color: #27ae60; color: white; }
        .btn-delete { background-color: #e74c3c; color: white; padding: 4px 10px; font-size: 0.8rem; margin-left: 10px;}
        
        ul { list-style: none; padding: 0; }
        li { background: #f9f9f9; border-bottom: 1px solid #eee; padding: 10px; display: flex; justify-content: space-between; align-items: center; }

        /* Tomato Timer */
        .timer-display { font-size: 3rem; font-weight: bold; text-align: center; margin: 20px 0; color: #e74c3c; }
        .timer-controls { display: flex; justify-content: center; gap: 10px; }
        .btn-start { background-color: #2980b9; color: white; }
        .btn-stop { background-color: #95a5a6; color: white; }

        /* Statistiche */
        .stats-box { margin-top: 15px; display: flex; justify-content: space-around; background: #eef2f3; padding: 10px; border-radius: 8px; }
        .stat-item { text-align: center; }
        .stat-value { font-weight: bold; color: #2980b9; font-size: 1.1rem; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìä La Tua Dashboard Personale</h1>

    <div class="dashboard-grid">
        
        <div class="card">
            <h2>üí∞ Obiettivi di Risparmio</h2>
            <div class="goal-input-group">
                <input type="text" id="goalName" placeholder="Es. Vacanza...">
                <input type="number" id="goalAmount" placeholder="‚Ç¨ Target">
                <button class="btn-add" onclick="addGoal()">Aggiungi</button>
            </div>
            <ul id="goalList">
                </ul>
        </div>

        <div class="card">
            <h2>üçÖ Tomato Focus Timer</h2>
            <div class="timer-display" id="timer">25:00</div>
            <div class="timer-controls">
                <button class="btn-start" onclick="startTimer()">Avvia</button>
                <button class="btn-stop" onclick="stopTimer()">Ferma / Blocca</button>
            </div>
        </div>

        <div class="card" style="grid-column: span 2;"> <h2>üìà Andamento Annuale (Entrate vs Uscite)</h2>
            <canvas id="financeChart" height="100"></canvas>
            
            <div class="stats-box">
                <div class="stat-item">
                    <div>Media Q1 (Gen-Mar)</div>
                    <div class="stat-value" id="q1Avg">‚Ç¨ 0</div>
                </div>
                <div class="stat-item">
                    <div>Media Q2 (Apr-Giu)</div>
                    <div class="stat-value" id="q2Avg">‚Ç¨ 0</div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    /* --- LOGICA OBIETTIVI RISPARMIO --- */
    let goals = [
        { name: "Fondo Emergenza", target: 1000 },
        { name: "Nuovo PC", target: 1500 }
    ];

    function renderGoals() {
        const list = document.getElementById('goalList');
        list.innerHTML = ''; // Pulisce la lista
        goals.forEach((goal, index) => {
            const li = document.createElement('li');
            li.innerHTML = `
                <span><strong>${goal.name}</strong>: ‚Ç¨${goal.target}</span>
                <button class="btn-delete" onclick="deleteGoal(${index})">Elimina</button>
            `;
            list.appendChild(li);
        });
    }

    function addGoal() {
        const name = document.getElementById('goalName').value;
        const amount = document.getElementById('goalAmount').value;
        if(name && amount) {
            goals.push({ name: name, target: amount });
            renderGoals();
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
        } else {
            alert("Inserisci nome e importo!");
        }
    }

    // FUNZIONE PER ELIMINARE OBIETTIVO
    function deleteGoal(index) {
        if(confirm("Vuoi davvero eliminare questo obiettivo?")) {
            goals.splice(index, 1); // Rimuove l'elemento all'indice specificato
            renderGoals(); // Ridisegna la lista
        }
    }

    /* --- LOGICA TOMATO TIMER --- */
    let timerInterval;
    let timeLeft = 25 * 60; // 25 minuti in secondi

    function updateDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        document.getElementById('timer').innerText = 
            `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    function startTimer() {
        if(timerInterval) return; // Evita di avviare pi√π timer contemporaneamente
        timerInterval = setInterval(() => {
            if(timeLeft > 0) {
                timeLeft--;
                updateDisplay();
            } else {
                alert("Tempo scaduto! Fai una pausa.");
                stopTimer();
            }
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timerInterval);
        timerInterval = null;
        timeLeft = 25 * 60; // Resetta a 25 minuti
        updateDisplay();
    }

    /* --- LOGICA GRAFICO E STATISTICHE --- */
    // Dati simulati
    const monthlyData = [1200, 1500, 1100, 1800, 1600, 1400, 1300, 1900, 2100, 1700, 2000, 2200];

    const ctx = document.getElementById('financeChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar', // MODIFICA: 'bar' crea il grafico a colonne
        data: {
            labels: ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago', 'Set', 'Ott', 'Nov', 'Dic'],
            datasets: [{
                label: 'Risparmio Netto (‚Ç¨)',
                data: monthlyData,
                backgroundColor: 'rgba(52, 152, 219, 0.6)',
                borderColor: 'rgba(52, 152, 219, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: { beginAtZero: true }
            }
        }
    });

    // CALCOLO MEDIE Q1 e Q2
    function calculateAverages() {
        // Q1 = Gen (0), Feb (1), Mar (2)
        const q1 = (monthlyData[0] + monthlyData[1] + monthlyData[2]) / 3;
        // Q2 = Apr (3), Mag (4), Giu (5)
        const q2 = (monthlyData[3] + monthlyData[4] + monthlyData[5]) / 3;

        document.getElementById('q1Avg').innerText = `‚Ç¨ ${q1.toFixed(2)}`;
        document.getElementById('q2Avg').innerText = `‚Ç¨ ${q2.toFixed(2)}`;
    }

    // Inizializzazione
    renderGoals();
    calculateAverages();

</script>

</body>
</html>
